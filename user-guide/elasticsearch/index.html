
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Compliant Kubernetes is a Kubernetes distribution that reduces the burden for complying with HIPAA, Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001.">
      
      
      
        <meta name="author" content="Elastisys AB">
      
      
        <link rel="canonical" href="https://compliantkubernetes.io/user-guide/elasticsearch/">
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.0">
    
    
      
        <title>Elasticsearch/Kibana - Compliant Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.33e2939f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-68368435-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logging" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Compliant Kubernetes" class="md-header__button md-logo" aria-label="Compliant Kubernetes" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Compliant Kubernetes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Elasticsearch/Kibana
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/elastisys/compliantkubernetes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Compliant Kubernetes" class="md-nav__button md-logo" aria-label="Compliant Kubernetes" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Compliant Kubernetes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/elastisys/compliantkubernetes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/" class="md-nav__link">
        Compliance Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../benefits/" class="md-nav__link">
        Exploring Benefits
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../harbor/" class="md-nav__link">
        Harbor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes-api/" class="md-nav__link">
        Kubernetes API
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Elasticsearch/Kibana
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Elasticsearch/Kibana
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compliance-needs" class="md-nav__link">
    Compliance needs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-distro-for-elasticsearch" class="md-nav__link">
    Open Distro for Elasticsearch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-using-kibana" class="md-nav__link">
    Visualization using Kibana
  </a>
  
    <nav class="md-nav" aria-label="Visualization using Kibana">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-visualization-and-exploration-in-kibana" class="md-nav__link">
    Data Visualization and Exploration in Kibana
  </a>
  
    <nav class="md-nav" aria-label="Data Visualization and Exploration in Kibana">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discover" class="md-nav__link">
    Discover
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    Visualize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dashboard" class="md-nav__link">
    Dashboard
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-falco-and-opa-logs" class="md-nav__link">
    Accessing Falco and OPA Logs
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../prometheus/" class="md-nav__link">
        Prometheus/Grafana
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dashboard/" class="md-nav__link">
        Dashboard
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../backup/" class="md-nav__link">
        Backups
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        CISO Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="CISO Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          CISO Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/backup/" class="md-nav__link">
        Backup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/cryptography/" class="md-nav__link">
        Cryptography
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/intrusion-detection/" class="md-nav__link">
        Intrusion Detection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/policy-as-code/" class="md-nav__link">
        Policy-as-Code
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/network-security/" class="md-nav__link">
        Network Security
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/kubernetes-status/" class="md-nav__link">
        Kubernetes Status
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Operator Manual
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operator Manual" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Operator Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_3" type="checkbox" id="__nav_8_3" >
      
      <label class="md-nav__link" for="__nav_8_3">
        Creating/Destroying/Upgrading a Cluster
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Creating/Destroying/Upgrading a Cluster" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_3">
          <span class="md-nav__icon md-icon"></span>
          Creating/Destroying/Upgrading a Cluster
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/aws/" class="md-nav__link">
        On AWS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/azure/" class="md-nav__link">
        On Azure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/exoscale/" class="md-nav__link">
        On Exoscale
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/gcp/" class="md-nav__link">
        On GCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/openstack/" class="md-nav__link">
        On Openstack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/ovh-managed-kubernetes/" class="md-nav__link">
        On OVH Managed Kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/eksd/" class="md-nav__link">
        On EKS-D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/clean-up/" class="md-nav__link">
        Remove Compliant Kubernetes Apps
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/qa/" class="md-nav__link">
        QA
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_5" type="checkbox" id="__nav_8_5" >
      
      <label class="md-nav__link" for="__nav_8_5">
        Configuring a Cluster
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configuring a Cluster" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_5">
          <span class="md-nav__icon md-icon"></span>
          Configuring a Cluster
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/ingress/" class="md-nav__link">
        Ingress
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/disaster-recovery/" class="md-nav__link">
        Disaster Recovery
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-manual/break-glass/" class="md-nav__link">
        Breaking the Glass
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        Developer Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/tech-radar/" class="md-nav__link">
        Tech Radar
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../adr/" class="md-nav__link">
        Architectural Decision Log
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://compliantkubernetes.com/" class="md-nav__link">
        Support ⧉
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/blog/" class="md-nav__link">
        Blog ⧉
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compliance-needs" class="md-nav__link">
    Compliance needs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-distro-for-elasticsearch" class="md-nav__link">
    Open Distro for Elasticsearch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-using-kibana" class="md-nav__link">
    Visualization using Kibana
  </a>
  
    <nav class="md-nav" aria-label="Visualization using Kibana">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-visualization-and-exploration-in-kibana" class="md-nav__link">
    Data Visualization and Exploration in Kibana
  </a>
  
    <nav class="md-nav" aria-label="Data Visualization and Exploration in Kibana">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discover" class="md-nav__link">
    Discover
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    Visualize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dashboard" class="md-nav__link">
    Dashboard
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-falco-and-opa-logs" class="md-nav__link">
    Accessing Falco and OPA Logs
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/elastisys/compliantkubernetes/edit/main/docs/user-guide/elasticsearch.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="logging">Logging</h1>
<p>Compliant Kubernetes (CK8S) provides the mechanism to manage your cluster as well as  the lifecycle of thousands of containerized applications deployed in  the cluster. The resources managed by CK8S are expected to be highly distributed with dynamic behaviors. An instance of CK8S cluster  environment involves several components with  nodes that host hundreds of containers that are constantly being spun up and destroyed based on workloads.</p>
<p>When dealing with a large pool of containerized applications and workloads in CK8S, it is imperative to be proactive with continuous monitoring and debugging information in order to observe what is going on the cluster. These information can be seen at the container, node, or cluster level.  Logging as one of the <a href="https://www.oreilly.com/library/view/distributed-systems-observability/9781492033431/ch04.html#:~:text=Logs%2C%20metrics%2C%20and%20traces%20are,ability%20to%20build%20better%20systems.">three pillars of observability</a> is a crucial element to manage and monitor services and infrastructure. It allows you to track debugging information at different levels of granularity.</p>
<h2 id="compliance-needs">Compliance needs</h2>
<p>The requirements to comply with ISO 27001 are stated in ISO <a href="https://www.isms.online/iso-27001/">27001:2013</a>. The annexes that mostly concerns logging are:</p>
<ul>
<li><a href="https://www.isms.online/iso-27001/annex-a-12-operations-security/">Annex 12</a>, article A.12.4.1 "Event Logging" and A.12.4.3 "Administrator and Operator Logs".</li>
<li><a href="https://www.isms.online/iso-27001/annex-a-16-information-security-incident-management/">Annex 16</a> which deals with incident management.</li>
</ul>
<p>In Compliant Kubernetes, Elasticsearch is separate from the production workload, hence it complies with A.12.4.2 "Protection of Log Information". The cloud provider should ensure that the clock of Kubernetes nodes is synchronized, hence complying with A.12.4.4 "Clock Synchronisation".</p>
<h2 id="open-distro-for-elasticsearch">Open Distro for Elasticsearch</h2>
<p>Raw logs in CK8S are normalized, filtered, and processed by <a href="https://www.fluentd.org/">fluentd</a> and shipped to Elasticsearch for storage and analysis. CK8S uses fully open source version of Elasticsearch called  <a href="https://logz.io/blog/open-distro-for-elasticsearch/">Open Distro for Elasticsearch</a>.</p>
<p>Open Distro for Elasticsearch provides a powerful, easy-to-use event monitoring and alerting system, enabling you to monitor, search, visualize your data among other things. Kibana is used as visualization and analysis interface  for Elasticsearch for all your logs.</p>
<h2 id="visualization-using-kibana">Visualization using Kibana</h2>
<p>Kibana is used as a data visualization and exploration tool for log time-series  and aggregate analytics. It offers powerful and easy-to-use features such as histograms, line graphs, pie charts, heat maps, and built-in geospatial support.</p>
<p>When you log into Kibana, you will encounter a page similar to the one shown below.</p>
<p><img alt="Kibana" src="../../img/kibana.png" /></p>
<p>Since we are concerned with searching logs and their visualization, we will focus on <strong>Visualize and Explore Data</strong> as   indicated by the red rectangle in the figure above. If you are interested to know more about the rest please visit the <a href="https://opendistro.github.io/for-elasticsearch-docs/docs/kibana/">official Kibana documentation</a>.</p>
<p>Before we dive into Kibana, let us discuss the type of logs ingested into Elasticsearch. Logs in CK8S cluster are filtered and indexed by fluentd into three categories:</p>
<ol>
<li>
<p><strong>kubeaudit logs</strong> related to <a href="https://kubernetes.io/docs/tasks/debug-application-cluster/audit/">Kubernetes audits</a> to provide security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system.
This is mostly related to the ISO 27001 requirement A.12.4.3 "Administrator and Operator Logs".</p>
</li>
<li>
<p><strong>Kubernetes logs</strong> that provide insight into CK8S resources such as nodes, Pods, containers, deployments and replica sets. This allows you to observe the interactions between those resources and see the effects that one action has on another. Generally, logs in the CK8S ecosystem can be divided into the cluster level (logs outputted by components such as the kubelet, the API server, the scheduler) and the application level (logs generated by pods and containers).
This is mostly related to the ISO 27001 requirement A.12.4.3 "Administrator and Operator Logs".</p>
</li>
<li>
<p><strong>Others</strong> logs other than the above two are indexed and shipped to Elasticsearch as <em>others</em>. Such logs are basically your application level logs.
This is mostly related to the ISO 27001 requirement A.12.4.1 "Event Logging".</p>
</li>
</ol>
<p>Let us dive into Kibana then.</p>
<h3 id="data-visualization-and-exploration-in-kibana">Data Visualization and Exploration in Kibana</h3>
<p>As you can see in the figure above, data visualzation and expoloration in Kibana has three components: <strong>Discover</strong>, <strong>Visualize</strong> and <strong>Dashboard</strong>.  The following section describes each components using examples.</p>
<h4 id="discover">Discover</h4>
<p>The <strong>discover</strong> component in  Kibana is used for exploring, searching and filtering logs.</p>
<p>Click <strong>Discover</strong> in the main Kibana page to access the features provided by it. The figure below shows partial view of the page that you will get under <strong>Discover</strong>.</p>
<p><img alt="Kibana" src="../../img/discover.png" /></p>
<p>As you can see in the above figure, the <strong>kubeaudit</strong> index logs are loaded by default. If you want to explore logs from either of the other two log indices please select the right index under the dropdown menu marked <em>log index category</em>.</p>
<p>To appreciate Kibana's searching and filtering capability, let us get data for the following question:</p>
<p><strong>Get all logs that were collected for the past 20 hours in host 172.16.0.3 where the responseStatus reason is notfound</strong></p>
<p>We can use different ways to find the answer for the question. Below is one possible solution.</p>
<ol>
<li>
<p>Write <strong>sourceIPs: 172.16.0.3</strong>  in the <strong>search textbox</strong>.</p>
</li>
<li>
<p>Click <strong>Add Filter</strong> and select <strong>responseStatus.reason</strong> and <strong>is</strong> under <strong>field</strong> and <strong>Operator</strong> dropdown menus respectively. Finally, enter
<strong>notfound</strong> under <strong>Value</strong> input box and click <strong>Save</strong>. The following figure shows the details.</p>
<p><img alt="Kibana" src="../../img/discover_filter.png" /></p>
</li>
<li>
<p>To enter the 20 hours, click part that is labelled <strong>Time</strong> in the <strong>Discover</strong> figure above, then enter <strong>20</strong> under the input box and select <strong>hours</strong> in the dropdown menu. Make sure that you are under <strong>Relative</strong> tab. Finally, click <strong>update</strong>. The following figure shows how to set the hours. Note that the data will be automatically updated as time passes to reflect the past 20 hours data from the current time.</p>
<p><img alt="Kibana" src="../../img/discover_hours.png" /></p>
</li>
</ol>
<p>Once you are done, you will see a result similar to the following figure.</p>
<p><img alt="Kibana" src="../../img/discover_filter_hours_result.png" /></p>
<h4 id="visualize">Visualize</h4>
<p>The <strong>Visualize</strong> component in Kibana is to create different visualizations. Let us create a couple of visualizations.</p>
<p>To create visualizations:</p>
<ol>
<li>Go to the main Kibana page and click <strong>Visual</strong>.</li>
<li>Click <strong>Create visualization</strong> link located on the top right side of the page.</li>
<li>Select a visualization type, we will use <strong>Pie</strong> here.</li>
<li>Choose the index name or saved query name, if any,  under <strong>NNew Pie / Choose a source</strong>. We will use the <strong>Kubernetes</strong> index here.</li>
</ol>
<p>By default a pie chart with the total number of logs will be provided by kibana. Let us divide the pie chart based on the number of logs contributed by each <strong>namespace</strong>. To do that perform the following steps:</p>
<ol>
<li>
<p>Under <strong>Buckets</strong> click <strong>add</strong> then <strong>Split Slices</strong>. See the figure below.</p>
<p><img alt="Kibana" src="../../img/add_bucket.png" /></p>
</li>
<li>
<p>Under <strong>aggregation</strong> select <strong>Significant Terms</strong> terms. see the figure below.</p>
<p><img alt="Kibana" src="../../img/aggregation.png" /></p>
</li>
<li>
<p>Select <strong>Kubernetes.namespace_name.keyword</strong> under <strong>field</strong>. See the figure below.</p>
<p><img alt="Kibana" src="../../img/namespace.png" /></p>
</li>
</ol>
<p>The final result will look like the following figure.</p>
<p><img alt="Kibana" src="../../img/namespace_pie.png" /></p>
<p>Please save the pie chart as we will use it later.</p>
<p>Let us create a similar pie chart using <strong>host</strong> instead of <strong>namespace</strong>. The chart will look like the following figure.</p>
<p><img alt="Kibana" src="../../img/host_pie.png" /></p>
<h4 id="dashboard">Dashboard</h4>
<p>The <strong>Dashboard</strong> component in Kibana is used for organizing related visualizations together.</p>
<p>Let us bring the  two visualizations that we created above together in a single dashboard.</p>
<p>To do that:</p>
<ol>
<li>Go to the main Kibana page and click <strong>Dashboard</strong>.</li>
<li>Click <strong>Create Dashboard</strong> link located on the top right side of the page.</li>
<li>Click <strong>Add existing</strong> link located on the left side.</li>
<li>Select the name of the two charts/visualizations that you created above.</li>
</ol>
<p>The figure below shows the dashboard generated from the above steps showing the two pie charts in a single page.</p>
<p><img alt="Kibana" src="../../img/dashboard.png" /></p>
<h2 id="accessing-falco-and-opa-logs">Accessing Falco and OPA Logs</h2>
<p>To access Falco or OPA logs, go to the  <strong>Discover</strong> panel and write <strong>Falco</strong> or <strong>OPA</strong> on the <strong>search textbox</strong>.  Make sure that  the <strong>Kubernetes</strong> log index category is selected.</p>
<p>The figure below shows  the search result for <strong>Falco</strong> logs.
<img alt="Falco logs" src="../../img/falco_log.png" /></p>
<p>The figure below shows the search result for <strong>OPA</strong> logs.
<img alt="OPA logs" src="../../img/opa_log.png" /></p>
<h1 id="further-reading">Further Reading</h1>
<ul>
<li><a href="https://opendistro.github.io/for-elasticsearch/">Open Distro for Elasticsearch</a></li>
<li><a href="https://opendistro.github.io/for-elasticsearch-docs/docs/kibana/">Kibana</a></li>
<li><a href="https://logz.io/blog/open-distro-for-elasticsearch/">Open Distro for Elasticsearch – How Different Is It?</a></li>
<li><a href="https://www.fluentd.org/">Fluentd</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../kubernetes-api/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Kubernetes API
            </div>
          </div>
        </a>
      
      
        <a href="../prometheus/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Prometheus/Grafana
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright © 2020 Elastisys AB
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.d892486b.min.js"></script>
      
    
  </body>
</html>